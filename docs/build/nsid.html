

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>NSID &mdash; pyTEMlib 0.2020.11.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> pyTEMlib
          

          
          </a>

          
            
            
              <div class="version">
                0.2020.11.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">p</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">pyTEMlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact us</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Credits</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyTEMlib</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>NSID</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/nsid.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="nsid">
<h1>NSID<a class="headerlink" href="#nsid" title="Permalink to this headline">¶</a></h1>
<p><strong>Suhas Somnath</strong></p>
<p>N-Dimensional Spectroscopy and Imaging Data (NSID)</p>
<div class="section" id="why-not-just-use-h5py">
<h2>Why not just use h5py?<a class="headerlink" href="#why-not-just-use-h5py" title="Permalink to this headline">¶</a></h2>
<p>h5py does indeed provide all the functionality necessary to support NSID. However, a layer of convenience and standardization is still useful / necessary for few reasons:</p>
<ol class="arabic simple">
<li><p>To ensure that data (in memory) are always stored in the same standardized fashion. This would be a function like <a class="reference external" href="https://pycroscopy.github.io/pyUSID/auto_examples/intermediate/plot_hdf_utils_write.html#write-main-dataset">pyUSID.hdf_utils.write_main_dataset()</a> or a class like <a class="reference external" href="https://pycroscopy.github.io/pyUSID/auto_examples/beginner/plot_numpy_translator.html#sphx-glr-auto-examples-beginner-plot-numpy-translator-py">pyUSID.ArrayTranslator</a>.</p></li>
<li><p>To make it easier to access relevant ancillary information from HDF5 datasets such as the dimensions, units, scales, etc. without needing to write a lot of h5py code. I anticpate that this may look like a class along the lines of <a class="reference external" href="https://pycroscopy.github.io/pyUSID/auto_examples/beginner/plot_usi_dataset.html">pyusid.USIDataset</a>. However, this class may extend a <code class="docutils literal notranslate"><span class="pre">dask.array</span></code> object instead of a h5py.Dataset object for simplicity. <code class="docutils literal notranslate"><span class="pre">xarray</span></code> apparently extends pandas which is inappropriate for this application. However, packages like <code class="docutils literal notranslate"><span class="pre">pint</span></code> should ceratinly be used.</p></li>
<li><p>To simplify certain ancillary tasks like identify all NSID datasets in a given file, seamlessly reusing datasets representing dimensions / copying datasets, verifying whether a dataset is indeed NSID or not.</p></li>
<li><p>To facilitate embarrasingly parallel computations on datasets along the lines of <a class="reference external" href="https://pycroscopy.github.io/pyUSID/auto_examples/intermediate/plot_process.html#sphx-glr-auto-examples-intermediate-plot-process-py">pyUSID.Process</a>. I would love to use dask to handle parallelization. However, HDF5 datasets are still not pickle-able. Therefore, Dask cannot operate on them. It is likely, that this framaework would rely on lower-level libraries like mpi4py</p></li>
</ol>
<p>I expect that the package to support NSID would be far simpler than pyUSID since h5py provides the majority of the functionality inherently.</p>
</div>
<div class="section" id="strawman-nsid-specifications">
<h2>Strawman NSID specifications<a class="headerlink" href="#strawman-nsid-specifications" title="Permalink to this headline">¶</a></h2>
<p>Originally the NSID model was envisioned to be similar to USID in that it too would have a <cite>Main Dataset</cite> that is supported by <cite>Ancillary Datasets</cite> to provide reference information about each dimension. The ancillary datasets for each dimension would be <a class="reference external" href="http://docs.h5py.org/en/stable/high/dims.html">attached</a> to the <cite>Main Dataset</cite> using HDF5 <a class="reference external" href="https://support.hdfgroup.org/HDF5/Tutor/h5dimscale.html">Dimension Scales</a>
However, I have since learnt that HDF5’s Dimension Scales can capture the information that would have been stored in these ancillary datasets and can be attached to the <cite>Main Dataset</cite>.</p>
<div class="section" id="main-dataset">
<h3>Main Dataset<a class="headerlink" href="#main-dataset" title="Permalink to this headline">¶</a></h3>
<p>The main data will be stored in an HDF5 dataset:</p>
<ul class="simple">
<li><p><strong>shape</strong>: Arbitrary - matching the dimensionality of the data</p></li>
<li><p><strong>dtype</strong>: basic types like integer, float, and complex only. I am told that compound-valued datasets are not supported well in languages other than python. Therefore, such data should be broken up into simpler dtype datasets.</p></li>
<li><p><strong>chunks</strong>: Leave as default / do not specify anything.</p></li>
<li><p><strong>compression</strong>: Preferably do not use anything. If compression is indeed necessary, consider using <cite>gzip</cite>.</p></li>
<li><p><strong>Dimension scales</strong>: Every single dimension needs to have at least one scale attached to it with the name(s) of the dimension(s) as the <a href="#id1"><span class="problematic" id="id2">`</span></a>label`(s) for the scale. Normally, we would only have one dataset attached to each dimension. However, for example, if one of the reference axes was a color (a tuple of three integers), we would need to attach three datasets to the scale for the appropriate dimension.</p></li>
<li><p><strong>Required Attributes</strong>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">quantity</span></code>: <cite>string</cite>: Physical quantity that is contained in this dataset</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">units</span></code>: <cite>string</cite>: Units for this physical quantity</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">data_type</span></code>: <a href="#id3"><span class="problematic" id="id4">`</span></a>string : What kind of data this is. Example - image, image stack, video, hyperspectral image, etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">modality</span></code>: <a href="#id5"><span class="problematic" id="id6">`</span></a>string : Experimental / simulation modality - scientific meaning of data. Example - photograph, TEM micrograph, SPM Force-Distance spectroscopy.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">source</span></code>: <a href="#id7"><span class="problematic" id="id8">`</span></a>string : Source for dataset like the kind of instrument. One could go very deep here into either the algorithmic details if this is a result from analysis or the exact configurations for the instrument that generated this daatset. I am inclined to remove this attribute and have this expressed in the metadata alone.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nsid_version</span></code>: <cite>string</cite>: Version of the abstract NSID model.</p></li>
</ul>
</li>
</ul>
<p>Note tha we should take guidance from experts in schemas and ontologies on how best to represent the <code class="docutils literal notranslate"><span class="pre">data_type</span></code> and <code class="docutils literal notranslate"><span class="pre">modality</span></code> information.</p>
</div>
<div class="section" id="ancillary-datasets">
<h3>Ancillary Datasets<a class="headerlink" href="#ancillary-datasets" title="Permalink to this headline">¶</a></h3>
<p>Each of the <cite>N</cite> dimensions corresponding to the <cite>N</cite>-dimensional <cite>Main Dataset</cite> would be an HDF5 dataset:</p>
<ul class="simple">
<li><p><strong>shape</strong> - 1D only</p></li>
<li><p><strong>dtype</strong> - Simple data types like int, float, complex</p></li>
<li><p><strong>Required attributes</strong> -</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">quantity</span></code>: <cite>string</cite>: Physical quantity that is contained in this dataset</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">units</span></code>: <cite>string</cite>: units for the physical quantity</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dimension_type</span></code>: <cite>string</cite>: Kind of dimension - ‘position’, ‘spectral’, ‘reciprocal’</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="metadata">
<h3>Metadata<a class="headerlink" href="#metadata" title="Permalink to this headline">¶</a></h3>
<p>Strawman solution - Store the heirarchical metadata into heirarchical HDF5 groups within the same file as the <cite>Main Dataset</cite> and link the parent group the provides the metadata to the <cite>Main Dataset</cite>. Again, this requires feedback from experts in schemas and ontologies.</p>
</div>
<div class="section" id="multiple-measurements-in-same-file">
<h3>Multiple measurements in same file<a class="headerlink" href="#multiple-measurements-in-same-file" title="Permalink to this headline">¶</a></h3>
<p>A single HDF5 file can contain multiple HDF5 datasets. It is not necessary that all datasets be NSID-specific. Similarly, the heirarchical nature of HDF5 will allow the storage of multiple NSID measurements within the same HDF5 file. Strict restrictions will not be placed on how the datasets should be arranged. Users are free to use and are recommended to use the same guidelienes of <a class="reference external" href="https://pycroscopy.github.io/USID/h5_usid.html#measurement-data">Measurement Groups</a> and <a class="reference external" href="https://pycroscopy.github.io/USID/usid_model.html#channels">Channels</a> as defined in USID.</p>
</div>
<div class="section" id="data-processing-results-in-same-file">
<h3>Data processing results in same file<a class="headerlink" href="#data-processing-results-in-same-file" title="Permalink to this headline">¶</a></h3>
<p>We defined a <a class="reference external" href="https://pycroscopy.github.io/USID/h5_usid.html#tool-analysis-processing">possible solution</a> for capturing provenance between the source dataset and the results datasets. Briefly, results would be stored in a group whose name would be formatted as <code class="docutils literal notranslate"><span class="pre">SourceDataset-ProcessingAlgorithmName_NumericIndex</span></code>. However, this solution does not work <em>elegantly</em> for certain situations:</p>
<ul class="simple">
<li><p>if multiple source datasets were used to produce a set of results datasets.</p></li>
<li><p>if results are written into a different file.</p></li>
<li><p>In general, the algorithm name was loosly defined.</p></li>
</ul>
<p>Do get in touch if you know of a better solution</p>
</div>
</div>
<div class="section" id="existing-solutions">
<h2>Existing solutions<a class="headerlink" href="#existing-solutions" title="Permalink to this headline">¶</a></h2>
<p>A while ago, I had come across the following resources:</p>
<ul class="simple">
<li><p>From UIUC folks - a webpage called <a class="reference external" href="https://emdatasets.com/format/">electron microscopy data</a></p></li>
<li><p>from the DREAM.3D folks - “<a class="reference external" href="https://iopscience.iop.org/article/10.1088/0965-0393/18/6/065008">MXA: a customizable HDF5-based data format for multi-dimensional data sets</a>” by Michael Jackson</p></li>
<li><p>From APS folks at Argonne - “<a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1107/S160057751401604X?sentby=iucr">Scientific data exchange: a schema for HDF5-based storage of raw and analyzed data</a>” by Francesco de Carlo.</p></li>
</ul>
<p>However, all of these were targeting a specific scientific sub-domain / modality. They were not as simple / general as pyNSID.</p>
<p>I am not sure if something like NSID or a python API like pyNSID exist now.
We would need to survey literature again for existing solutions to avoid duplicating efforts and for supporting an existing central effort.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Gerd Duscher, and Mark Oxeley

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>